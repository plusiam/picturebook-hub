<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>그림책 수업 허브</title>
    <style>
        /* ============ CSS 스타일 ============ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #48bb78;
            --warning: #f6ad55;
            --danger: #f56565;
            --light: #f7fafc;
            --dark: #2d3748;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* 헤더 */
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        /* 검색 및 필터 */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .filter-tag {
            padding: 8px 16px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-tag:hover {
            background: #e0e0e0;
        }

        .filter-tag.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* 통계 정보 */
        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            flex: 1;
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        /* 그림책 그리드 */
        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .book-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .book-cover {
            height: 180px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .book-cover-emoji {
            font-size: 4rem;
            opacity: 0.9;
        }

        .book-info {
            padding: 20px;
        }

        .book-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .book-author {
            color: #666;
            font-size: 0.95rem;
            margin-bottom: 12px;
        }

        .book-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }

        .tag {
            background: #f0f0f0;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            color: #666;
        }

        .book-actions {
            display: flex;
            gap: 10px;
            padding-top: 12px;
            border-top: 1px solid #f0f0f0;
        }

        .action-btn {
            flex: 1;
            padding: 8px;
            background: transparent;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* 모달 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
        }

        .modal.active {
            display: block;
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 1000px;
            margin: 30px auto;
            border-radius: 20px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            border-radius: 20px 20px 0 0;
            position: relative;
        }

        .modal-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .close-btn {
            position: absolute;
            right: 20px;
            top: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .modal-body {
            padding: 30px;
        }

        .activity-section {
            margin-bottom: 35px;
        }

        .activity-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .activity-content {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .activity-content h4 {
            color: #555;
            margin-bottom: 10px;
        }

        .question-box {
            background: white;
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .question-type {
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .worksheet-btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--success), #38a169);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            margin-top: 15px;
        }

        .worksheet-btn:hover {
            transform: translateY(-2px);
        }

        /* 추가 버튼 */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
        }

        .fab-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .fab-btn:hover {
            transform: scale(1.1);
        }

        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: none;
        }

        .fab-menu.active {
            display: block;
        }

        .fab-menu-item {
            display: block;
            width: 200px;
            padding: 12px 20px;
            background: white;
            border: none;
            text-align: left;
            margin-bottom: 5px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            cursor: pointer;
        }

        .fab-menu-item:hover {
            background: #f0f0f0;
        }

        /* 반응형 디자인 */
        @media (max-width: 768px) {
            .books-grid {
                grid-template-columns: 1fr;
            }
            
            .stats {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        /* 로딩 애니메이션 */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        /* 프린트 스타일 */
        @media print {
            .controls, .fab, .book-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <div class="header">
            <h1>📚 그림책 수업 허브</h1>
            <p>읽기 전 · 읽기 중 · 읽기 후 활동으로 구성된 체계적인 그림책 수업</p>
        </div>

        <!-- 통계 -->
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalBooks">0</div>
                <div class="stat-label">준비된 그림책</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalTags">0</div>
                <div class="stat-label">다양한 주제</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalActivities">0</div>
                <div class="stat-label">즐거운 활동</div>
            </div>
        </div>

        <!-- 검색 및 필터 -->
        <div class="controls">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="그림책 제목, 작가, 주제로 검색...">
                <button class="btn" onclick="searchBooks()">🔍 검색</button>
                <button class="btn" onclick="resetFilter()">↺ 초기화</button>
            </div>
            <div class="filter-tags" id="filterTags">
                <!-- 태그 필터가 동적으로 생성됨 -->
            </div>
        </div>

        <!-- 그림책 그리드 -->
        <div class="books-grid" id="booksGrid">
            <!-- 그림책 카드가 동적으로 생성됨 -->
        </div>
    </div>

    <!-- 상세보기 모달 -->
    <div class="modal" id="bookModal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close-btn" onclick="closeModal()">&times;</button>
                <h2 id="modalTitle">그림책 제목</h2>
                <p id="modalAuthor">작가</p>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- 활동 내용이 동적으로 생성됨 -->
            </div>
        </div>
    </div>

    <!-- 플로팅 액션 버튼 -->
    <div class="fab">
        <div class="fab-menu" id="fabMenu">
            <button class="fab-menu-item" onclick="addNewBook()">📖 새 그림책 추가</button>
            <button class="fab-menu-item" onclick="exportData()">💾 데이터 내보내기</button>
            <button class="fab-menu-item" onclick="printView()">🖨️ 인쇄용 보기</button>
            <button class="fab-menu-item" onclick="openGitHub()">💬 피드백 남기기</button>
        </div>
        <button class="fab-btn" onclick="toggleFabMenu()">+</button>
    </div>

    <script>
        // ============ 데이터베이스 ============
        const booksData = [
            {
                id: 1,
                title: "무지개 물고기",
                author: "마르쿠스 피스터",
                emoji: "🐠",
                tags: ["우정", "나눔", "자아성찰"],
                grade: ["1-2학년", "3-4학년"],
                activities: {
                    before: {
                        storytelling: "반짝이는 비늘을 가진 물고기가 있었어요. 친구들이 부러워하지만 혼자인 이 물고기는 어떤 고민을 하고 있을까요?",
                        prediction: [
                            "표지의 반짝이는 물고기를 보며 이야기 예상하기",
                            "제목의 '무지개'가 의미하는 것 생각해보기",
                            "물고기의 표정에서 감정 읽어내기"
                        ]
                    },
                    during: {
                        factCheck: [
                            "무지개 물고기의 비늘은 어떤 특징이 있나요?",
                            "다른 물고기들은 왜 무지개 물고기를 피하게 되었나요?",
                            "문어 할머니는 무지개 물고기에게 어떤 조언을 했나요?"
                        ],
                        interaction: [
                            "만약 여러분이 무지개 물고기라면 어떤 선택을 했을까요?",
                            "친구들과 나누었던 특별한 경험이 있나요?",
                            "혼자 특별한 것을 가지고 있을 때와 함께 나눌 때의 기분은 어떻게 다를까요?"
                        ]
                    },
                    after: {
                        reflection: [
                            "진정한 아름다움은 무엇일까요?",
                            "나눔이 우리 삶에 가져다주는 변화는 무엇인가요?",
                            "내가 가진 것 중 친구들과 나눌 수 있는 것은 무엇이 있을까요?"
                        ],
                        worksheetUrl: "https://forms.gle/example1"  // Google Forms 링크로 교체
                    }
                }
            },
            {
                id: 2,
                title: "괜찮아",
                author: "최숙희",
                emoji: "🤗",
                tags: ["위로", "공감", "성장"],
                grade: ["1-2학년"],
                activities: {
                    before: {
                        storytelling: "넘어진 아이, 실수한 아이, 혼자인 아이... 모두에게 필요한 한 마디가 있다면 무엇일까요?",
                        prediction: [
                            "표지 속 아이의 표정과 자세 관찰하기",
                            "'괜찮아'라는 말이 주는 느낌 나누기",
                            "누군가에게 위로받았던 경험 떠올리기"
                        ]
                    },
                    during: {
                        factCheck: [
                            "이야기 속에 등장하는 아이들은 어떤 상황에 있나요?",
                            "어른들은 아이들에게 어떤 말을 해주나요?",
                            "아이들의 표정은 어떻게 변화하나요?"
                        ],
                        interaction: [
                            "'괜찮아'라는 말을 들었을 때 어떤 기분이 드나요?",
                            "친구가 힘들어할 때 어떻게 위로해주나요?",
                            "실수했을 때 자신에게 해주고 싶은 말은?"
                        ]
                    },
                    after: {
                        reflection: [
                            "실수와 실패를 대하는 우리의 자세는 어떠해야 할까요?",
                            "나 자신을 격려하는 방법은 무엇이 있을까요?",
                            "주변 사람들에게 힘이 되는 말 한마디를 전한다면?"
                        ],
                        worksheetUrl: "https://forms.gle/example2"
                    }
                }
            },
            {
                id: 3,
                title: "알사탕",
                author: "백희나",
                emoji: "🍬",
                tags: ["소통", "이해", "마법", "가족"],
                grade: ["3-4학년"],
                activities: {
                    before: {
                        storytelling: "만약 다른 사람의 마음을 들을 수 있는 마법 사탕이 있다면, 어떤 일이 일어날까요?",
                        prediction: [
                            "제목 '알사탕'의 의미 추측하기",
                            "표지 속 구슬들의 정체 상상하기",
                            "마음을 읽을 수 있다면 좋은 점과 나쁜 점 생각하기"
                        ]
                    },
                    during: {
                        factCheck: [
                            "동동이는 어디서 알사탕을 얻게 되었나요?",
                            "알사탕을 먹으면 어떤 일이 일어나나요?",
                            "동동이가 들은 마음의 소리들은 무엇이었나요?"
                        ],
                        interaction: [
                            "아빠, 엄마, 강아지의 진짜 마음을 알게 된 동동이의 기분은?",
                            "내 마음을 다른 사람이 알게 된다면 어떨까요?",
                            "말하지 않아도 알아주었으면 하는 내 마음은?"
                        ]
                    },
                    after: {
                        reflection: [
                            "겉으로 보이는 모습과 속마음이 다를 때가 있나요?",
                            "진정한 소통을 위해 필요한 것은 무엇일까요?",
                            "오늘 가족이나 친구에게 전하고 싶은 마음은?"
                        ],
                        worksheetUrl: "https://forms.gle/example3"
                    }
                }
            },
            {
                id: 4,
                title: "치킨 마스크",
                author: "우쓰기 미호",
                emoji: "🐔",
                tags: ["용기", "자신감", "변화"],
                grade: ["1-2학년", "3-4학년"],
                activities: {
                    before: {
                        storytelling: "소심한 아이가 특별한 가면을 쓰면 어떤 일이 일어날까요? 가면이 주는 힘은 무엇일까요?",
                        prediction: [
                            "표지의 닭 가면이 주는 느낌 이야기하기",
                            "가면을 쓰면 달라지는 것들 상상하기",
                            "나에게도 필요한 '마스크'가 있을까?"
                        ]
                    },
                    during: {
                        factCheck: [
                            "주인공은 왜 치킨 마스크를 쓰게 되었나요?",
                            "마스크를 쓴 후 어떤 변화가 있었나요?",
                            "결국 마스크 없이도 할 수 있게 된 것은?"
                        ],
                        interaction: [
                            "용기가 필요했던 순간이 있었나요?",
                            "나를 더 강하게 만들어주는 것은 무엇인가요?",
                            "진짜 용기란 무엇일까요?"
                        ]
                    },
                    after: {
                        reflection: [
                            "외부의 도움 없이도 용기를 낼 수 있는 방법은?",
                            "나의 숨겨진 능력은 무엇일까요?",
                            "자신감을 키우는 나만의 방법 만들기"
                        ],
                        worksheetUrl: "https://forms.gle/example4"
                    }
                }
            },
            {
                id: 5,
                title: "책먹는 여우",
                author: "프란치스카 비어만",
                emoji: "🦊",
                tags: ["독서", "창의성", "도전"],
                grade: ["3-4학년", "5-6학년"],
                activities: {
                    before: {
                        storytelling: "책을 정말로 '먹는' 여우가 있다면? 그 여우에게는 어떤 일이 일어날까요?",
                        prediction: [
                            "제목의 '책먹는'이 의미하는 것 추측하기",
                            "여우가 책을 먹는 이유 상상하기",
                            "책을 먹으면 어떤 일이 일어날까?"
                        ]
                    },
                    during: {
                        factCheck: [
                            "여우는 어떻게 책을 먹게 되었나요?",
                            "책을 먹은 여우에게 일어난 변화는?",
                            "여우가 직접 쓴 이야기는 어땠나요?"
                        ],
                        interaction: [
                            "책을 '먹는다'는 것의 진짜 의미는?",
                            "내가 가장 '맛있게' 읽은 책은?",
                            "나도 이야기를 만들고 싶어진 적이 있나요?"
                        ]
                    },
                    after: {
                        reflection: [
                            "독서가 우리에게 주는 것은 무엇일까요?",
                            "읽기와 쓰기의 관계는?",
                            "나만의 이야기를 만든다면?"
                        ],
                        worksheetUrl: "https://forms.gle/example5"
                    }
                }
            },
            {
                id: 6,
                title: "나는 나의 주인",
                author: "채인선",
                emoji: "👑",
                tags: ["자존감", "정체성", "용기"],
                grade: ["5-6학년"],
                activities: {
                    before: {
                        storytelling: "남들이 정해준 길이 아닌, 내가 선택한 나만의 길을 간다는 것은 어떤 의미일까요?",
                        prediction: [
                            "'나의 주인'이 된다는 것의 의미",
                            "표지 속 인물의 당당한 표정 관찰하기",
                            "스스로 결정한다는 것의 중요성"
                        ]
                    },
                    during: {
                        factCheck: [
                            "주인공은 어떤 선택의 순간들을 맞이하나요?",
                            "주변 사람들의 반응은 어떠했나요?",
                            "주인공이 깨달은 것은 무엇인가요?"
                        ],
                        interaction: [
                            "스스로 결정했을 때와 남이 정해줬을 때의 차이는?",
                            "나만의 개성과 장점은 무엇인가요?",
                            "다른 사람과 다르다는 것이 주는 의미는?"
                        ]
                    },
                    after: {
                        reflection: [
                            "진정한 나 자신이 된다는 것은?",
                            "남과 비교하지 않고 나를 사랑하는 방법은?",
                            "내 삶의 주인공으로 살아가기 위해 필요한 것은?"
                        ],
                        worksheetUrl: "https://forms.gle/example6"
                    }
                }
            },
            {
                id: 7,
                title: "똥은 참 대단해!",
                author: "후지타 노리코",
                emoji: "💩",
                tags: ["과학", "유머", "자연", "환경"],
                grade: ["1-2학년", "3-4학년"],
                activities: {
                    before: {
                        storytelling: "모든 동물이 누는 똥! 그런데 똥이 왜 대단할까요? 똥에는 어떤 비밀이 숨어있을까요?",
                        prediction: [
                            "표지를 보고 등장할 동물들 예상하기",
                            "'대단하다'는 표현의 의미 생각하기",
                            "똥이 필요한 이유 추측해보기"
                        ]
                    },
                    during: {
                        factCheck: [
                            "동물마다 똥의 모양이 다른 이유는?",
                            "똥이 자연에서 하는 역할은 무엇인가요?",
                            "어떤 동물의 똥이 가장 특별했나요?"
                        ],
                        interaction: [
                            "가장 신기했던 동물의 똥은?",
                            "똥이 없다면 지구는 어떻게 될까요?",
                            "동물들의 똥으로 알 수 있는 정보는?"
                        ]
                    },
                    after: {
                        reflection: [
                            "자연의 순환에서 똥의 역할은 무엇일까요?",
                            "우리가 버리는 것들도 쓸모가 있을까요?",
                            "환경을 위해 우리가 할 수 있는 일은?"
                        ],
                        worksheetUrl: "https://forms.gle/example7"
                    }
                }
            },
            {
                id: 8,
                title: "고맙습니다, 선생님",
                author: "패트리샤 폴라코",
                emoji: "👩‍🏫",
                tags: ["감사", "성장", "멘토", "교육"],
                grade: ["3-4학년", "5-6학년"],
                activities: {
                    before: {
                        storytelling: "읽기를 어려워하는 한 아이가 있었습니다. 이 아이를 변화시킨 특별한 선생님의 이야기를 들어볼까요?",
                        prediction: [
                            "제목에서 느껴지는 감정 나누기",
                            "나에게 고마운 선생님 떠올리기",
                            "선생님이 학생에게 줄 수 있는 가장 큰 선물은?"
                        ]
                    },
                    during: {
                        factCheck: [
                            "주인공은 어떤 어려움을 겪고 있었나요?",
                            "선생님은 어떤 방법으로 도움을 주었나요?",
                            "주인공에게 일어난 변화는 무엇인가요?"
                        ],
                        interaction: [
                            "어려움을 극복하는데 도움을 준 사람이 있나요?",
                            "누군가를 진심으로 이해한다는 것은?",
                            "포기하지 않고 계속 도전하는 힘은 어디서 올까요?"
                        ]
                    },
                    after: {
                        reflection: [
                            "진정한 가르침이란 무엇일까요?",
                            "감사의 마음을 표현하는 방법은?",
                            "나도 누군가에게 힘이 되어줄 수 있을까요?"
                        ],
                        worksheetUrl: "https://forms.gle/example8"
                    }
                }
            },
            {
                id: 9,
                title: "내 이름은 자가주",
                author: "르네 고시니",
                emoji: "👦",
                tags: ["모험", "우정", "상상력"],
                grade: ["3-4학년", "5-6학년"],
                activities: {
                    before: {
                        storytelling: "평범한 일상도 특별한 모험이 될 수 있을까요? 자가주의 눈으로 본 세상은 어떤 모습일까요?",
                        prediction: [
                            "제목의 주인공 이름이 주는 느낌",
                            "표지에서 느껴지는 이야기 분위기",
                            "나의 일상 속 특별한 순간들"
                        ]
                    },
                    during: {
                        factCheck: [
                            "자가주는 어떤 성격의 아이인가요?",
                            "자가주와 친구들 사이에 일어난 사건들은?",
                            "어른들은 자가주를 어떻게 바라보나요?"
                        ],
                        interaction: [
                            "자가주처럼 상상력이 풍부했던 순간은?",
                            "일상을 특별하게 만드는 방법은?",
                            "친구들과의 추억 중 가장 기억에 남는 것은?"
                        ]
                    },
                    after: {
                        reflection: [
                            "어린 시절의 상상력이 주는 의미는?",
                            "평범한 일상을 특별하게 만드는 것은?",
                            "나만의 이야기를 만든다면?"
                        ],
                        worksheetUrl: "https://forms.gle/example9"
                    }
                }
            },
            {
                id: 10,
                title: "까만 아기 양",
                author: "엘리자베스 쇼",
                emoji: "🐑",
                tags: ["다양성", "포용", "자아정체성"],
                grade: ["1-2학년", "3-4학년"],
                activities: {
                    before: {
                        storytelling: "하얀 양들 사이에 태어난 까만 아기 양. 다르다는 것은 약점일까요, 아니면 특별함일까요?",
                        prediction: [
                            "표지의 까만 양이 느끼는 감정 추측하기",
                            "'다르다'는 것의 의미 생각하기",
                            "나와 다른 친구를 대하는 방법"
                        ]
                    },
                    during: {
                        factCheck: [
                            "까만 아기 양은 어떤 일을 겪었나요?",
                            "다른 양들의 반응은 어떠했나요?",
                            "까만 양이 특별해진 이유는?"
                        ],
                        interaction: [
                            "다르다고 느꼈던 순간이 있나요?",
                            "차이를 인정하고 존중하는 방법은?",
                            "나만의 특별함은 무엇인가요?"
                        ]
                    },
                    after: {
                        reflection: [
                            "다양성이 우리 사회에 주는 의미는?",
                            "서로 다름을 인정하는 것이 왜 중요할까요?",
                            "나와 다른 사람을 이해하는 방법은?"
                        ],
                        worksheetUrl: "https://forms.gle/example10"
                    }
                }
            }
        ];

        // ============ 전역 변수 ============
        let currentBooks = [...booksData];
        let selectedTags = [];

        // ============ 초기화 함수 ============
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            renderBooks(booksData);
            renderFilterTags();
            updateStats();
            
            // 엔터키 검색 이벤트
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchBooks();
                }
            });
        }

        // ============ 통계 업데이트 ============
        function updateStats() {
            document.getElementById('totalBooks').textContent = currentBooks.length;
            
            const allTags = new Set();
            currentBooks.forEach(book => {
                book.tags.forEach(tag => allTags.add(tag));
            });
            document.getElementById('totalTags').textContent = allTags.size;
            
            const totalActivities = currentBooks.reduce((sum, book) => {
                const beforeCount = 2; // storytelling + prediction
                const duringCount = 2; // factCheck + interaction
                const afterCount = 2;  // reflection + worksheet
                return sum + beforeCount + duringCount + afterCount;
            }, 0);
            document.getElementById('totalActivities').textContent = totalActivities;
        }

        // ============ 필터 태그 렌더링 ============
        function renderFilterTags() {
            const allTags = new Set();
            booksData.forEach(book => {
                book.tags.forEach(tag => allTags.add(tag));
            });
            
            const filterContainer = document.getElementById('filterTags');
            filterContainer.innerHTML = '';
            
            Array.from(allTags).sort().forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.className = 'filter-tag';
                tagElement.textContent = `#${tag}`;
                tagElement.onclick = () => toggleTag(tag, tagElement);
                filterContainer.appendChild(tagElement);
            });
        }

        // ============ 태그 필터링 ============
        function toggleTag(tag, element) {
            element.classList.toggle('active');
            
            if (selectedTags.includes(tag)) {
                selectedTags = selectedTags.filter(t => t !== tag);
            } else {
                selectedTags.push(tag);
            }
            
            filterBooks();
        }

        function filterBooks() {
            if (selectedTags.length === 0) {
                currentBooks = [...booksData];
            } else {
                currentBooks = booksData.filter(book => 
                    selectedTags.some(tag => book.tags.includes(tag))
                );
            }
            
            renderBooks(currentBooks);
            updateStats();
        }

        // ============ 검색 기능 ============
        function searchBooks() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (searchTerm === '') {
                currentBooks = [...booksData];
            } else {
                currentBooks = booksData.filter(book => 
                    book.title.toLowerCase().includes(searchTerm) ||
                    book.author.toLowerCase().includes(searchTerm) ||
                    book.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                );
            }
            
            renderBooks(currentBooks);
            updateStats();
        }

        function resetFilter() {
            document.getElementById('searchInput').value = '';
            selectedTags = [];
            currentBooks = [...booksData];
            
            document.querySelectorAll('.filter-tag').forEach(tag => {
                tag.classList.remove('active');
            });
            
            renderBooks(currentBooks);
            updateStats();
        }

        // ============ 그림책 카드 렌더링 ============
        function renderBooks(books) {
            const grid = document.getElementById('booksGrid');
            
            if (books.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: white;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">📚</div>
                        <h3>검색 결과가 없습니다</h3>
                        <p>다른 검색어나 필터를 시도해보세요</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = books.map(book => `
                <div class="book-card fade-in">
                    <div class="book-cover" onclick="openModal(${book.id})">
                        <div class="book-cover-emoji">${book.emoji || '📖'}</div>
                    </div>
                    <div class="book-info">
                        <div class="book-title">${book.title}</div>
                        <div class="book-author">${book.author}</div>
                        <div class="book-tags">
                            ${book.tags.map(tag => `<span class="tag">#${tag}</span>`).join('')}
                        </div>
                        <div class="book-actions">
                            <button class="action-btn" onclick="openModal(${book.id})">
                                📖 자세히
                            </button>
                            <button class="action-btn" onclick="openWorksheet('${book.activities.after.worksheetUrl}')">
                                📝 학습지
                            </button>
                            <button class="action-btn" onclick="shareBook(${book.id})">
                                🔗 공유
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ============ 모달 관련 함수 ============
        function openModal(bookId) {
            const book = booksData.find(b => b.id === bookId);
            if (!book) return;
            
            document.getElementById('modalTitle').textContent = book.title;
            document.getElementById('modalAuthor').textContent = `${book.author} | ${book.grade ? book.grade.join(', ') : '전학년'}`;
            
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <!-- 읽기 전 활동 -->
                <div class="activity-section">
                    <div class="activity-title">
                        <div class="activity-icon">🎯</div>
                        읽기 전 활동
                    </div>
                    
                    <div class="activity-content">
                        <h4>📖 스토리텔링</h4>
                        <p>${book.activities.before.storytelling}</p>
                    </div>
                    
                    <div class="activity-content">
                        <h4>🔮 내용 예상하기</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${book.activities.before.prediction.map(item => 
                                `<li style="padding: 8px 0;">✓ ${item}</li>`
                            ).join('')}
                        </ul>
                    </div>
                </div>

                <!-- 읽기 중 활동 -->
                <div class="activity-section">
                    <div class="activity-title">
                        <div class="activity-icon">📚</div>
                        읽기 중 활동
                    </div>
                    
                    <div class="activity-content">
                        <h4>🔍 사실확인 질문</h4>
                        ${book.activities.during.factCheck.map(q => `
                            <div class="question-box">
                                <div class="question-type">사실확인</div>
                                ${q}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="activity-content">
                        <h4>💬 상호교류 질문</h4>
                        ${book.activities.during.interaction.map(q => `
                            <div class="question-box">
                                <div class="question-type">상호교류</div>
                                ${q}
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- 읽기 후 활동 -->
                <div class="activity-section">
                    <div class="activity-title">
                        <div class="activity-icon">✨</div>
                        읽기 후 활동
                    </div>
                    
                    <div class="activity-content">
                        <h4>🌟 성찰 질문</h4>
                        ${book.activities.after.reflection.map(q => `
                            <div class="question-box">
                                <div class="question-type">성찰</div>
                                ${q}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="activity-content">
                        <h4>📝 독후 활동</h4>
                        <p>학생들의 생각을 정리하고 창의적인 활동을 할 수 있는 학습지를 제공합니다.</p>
                        <a href="${book.activities.after.worksheetUrl}" target="_blank" class="worksheet-btn">
                            📝 웹 학습지 바로가기 →
                        </a>
                    </div>
                </div>

                <!-- 추가 액션 버튼 -->
                <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #f0f0f0; display: flex; gap: 10px;">
                    <button class="btn" onclick="printLesson(${book.id})">🖨️ 수업안 인쇄</button>
                    <button class="btn" onclick="exportLesson(${book.id})">💾 수업안 저장</button>
                    <button class="btn" onclick="shareBook(${book.id})">🔗 링크 공유</button>
                </div>
            `;
            
            document.getElementById('bookModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('bookModal').classList.remove('active');
        }

        // ESC 키로 모달 닫기
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // 모달 외부 클릭시 닫기
        document.getElementById('bookModal').addEventListener('click', function(e) {
            if (e.target === document.getElementById('bookModal')) {
                closeModal();
            }
        });

        // ============ FAB 메뉴 ============
        function toggleFabMenu() {
            document.getElementById('fabMenu').classList.toggle('active');
        }

        // ============ 추가 기능들 ============
        function openWorksheet(url) {
            if (url.startsWith('http')) {
                window.open(url, '_blank');
            } else {
                alert('학습지 링크를 Google Forms 링크로 교체해주세요.');
            }
        }

        function shareBook(bookId) {
            const book = booksData.find(b => b.id === bookId);
            const shareUrl = `${window.location.href}#book-${bookId}`;
            const shareText = `📚 ${book.title} - 그림책 수업 자료\n작가: ${book.author}\n`;
            
            if (navigator.share) {
                navigator.share({
                    title: book.title,
                    text: shareText,
                    url: shareUrl
                });
            } else {
                // 클립보드에 복사
                const tempInput = document.createElement('input');
                tempInput.value = shareUrl;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                alert('링크가 클립보드에 복사되었습니다!');
            }
        }

        function printLesson(bookId) {
            const book = booksData.find(b => b.id === bookId);
            const printWindow = window.open('', '_blank');
            
            const printContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${book.title} - 수업안</title>
                    <style>
                        body { 
                            font-family: 'Malgun Gothic', sans-serif; 
                            line-height: 1.8;
                            padding: 20px;
                        }
                        h1 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
                        h2 { color: #667eea; margin-top: 30px; }
                        .section { margin: 20px 0; }
                        .question { 
                            background: #f8f9fa; 
                            padding: 10px; 
                            margin: 10px 0;
                            border-left: 3px solid #667eea;
                        }
                        @media print { 
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <h1>📚 ${book.title}</h1>
                    <p>작가: ${book.author} | 대상: ${book.grade ? book.grade.join(', ') : '전학년'}</p>
                    
                    <h2>읽기 전 활동</h2>
                    <div class="section">
                        <h3>스토리텔링</h3>
                        <p>${book.activities.before.storytelling}</p>
                        <h3>내용 예상하기</h3>
                        ${book.activities.before.prediction.map(p => `<div class="question">• ${p}</div>`).join('')}
                    </div>
                    
                    <h2>읽기 중 활동</h2>
                    <div class="section">
                        <h3>사실확인 질문</h3>
                        ${book.activities.during.factCheck.map(q => `<div class="question">${q}</div>`).join('')}
                        <h3>상호교류 질문</h3>
                        ${book.activities.during.interaction.map(q => `<div class="question">${q}</div>`).join('')}
                    </div>
                    
                    <h2>읽기 후 활동</h2>
                    <div class="section">
                        <h3>성찰 질문</h3>
                        ${book.activities.after.reflection.map(q => `<div class="question">${q}</div>`).join('')}
                    </div>
                    
                    <button class="no-print" onclick="window.print()">🖨️ 인쇄하기</button>
                </body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
        }

        function exportLesson(bookId) {
            const book = booksData.find(b => b.id === bookId);
            const dataStr = JSON.stringify(book, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportLink = document.createElement('a');
            exportLink.setAttribute('href', dataUri);
            exportLink.setAttribute('download', `${book.title}_수업안.json`);
            document.body.appendChild(exportLink);
            exportLink.click();
            document.body.removeChild(exportLink);
        }

        function addNewBook() {
            alert(`
📚 새 그림책 추가 방법:

1. GitHub에서 이 저장소를 Fork하세요
2. data/books.js 파일을 편집하세요
3. Pull Request를 보내주세요

또는

직접 books.js 파일을 수정하여 새 그림책을 추가하세요.
            `);
        }

        function exportData() {
            const dataStr = JSON.stringify(booksData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportLink = document.createElement('a');
            exportLink.setAttribute('href', dataUri);
            exportLink.setAttribute('download', 'picturebook_hub_data.json');
            document.body.appendChild(exportLink);
            exportLink.click();
            document.body.removeChild(exportLink);
        }

        function printView() {
            window.print();
        }

        function openGitHub() {
            // plusiam의 GitHub Issues 페이지로 이동
            const githubUrl = 'https://github.com/plusiam/picturebook-hub/issues/new';
            const issueTitle = '[피드백] ';
            const issueBody = `
## 피드백 종류
- [ ] 버그 신고
- [ ] 기능 제안
- [ ] 그림책 추가 요청
- [ ] 기타

## 상세 내용
(여기에 피드백을 작성해주세요)
            `;
            
            const url = `${githubUrl}?title=${encodeURIComponent(issueTitle)}&body=${encodeURIComponent(issueBody)}`;
            window.open(url, '_blank');
        }

        // ============ URL 해시 처리 (직접 링크) ============
        window.addEventListener('hashchange', handleHashChange);
        window.addEventListener('load', handleHashChange);

        function handleHashChange() {
            const hash = window.location.hash;
            if (hash.startsWith('#book-')) {
                const bookId = parseInt(hash.replace('#book-', ''));
                if (bookId) {
                    openModal(bookId);
                }
            }
        }
    </script>
</body>
</html>